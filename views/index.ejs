<!DOCTYPE html>
<html lang="en">

<%- include('layouts/header'); -%>

<body>

<a class="nav-link" href="/upload">New Post</a>
<main>
  <div id="page-wrapper">
    <div id="container" class="container">
     
          <div class="row-1" id="row-1">
            <div class="logo-column" id="logo-column"></div>
            <div class="logo" id="logo">STAY GOLDEN</div>
          </div>
          <% blogposts.reverse().forEach(posts =>  { %> 
          <div class="row-2" id="row-2">
            <div class="left-column">
              <div class="bicycle-map">
                <img src="img/bicycle-pin-svgrepo-com.svg" />
              </div>
              <div class="title-column"> 
                <p class="title"><%= posts.city + ", " + posts.state %></p>
                <p class="date"><%= posts.datePosted.toDateString() %></p>
              </div>
            </div>
            <div id="home-image">
              <img src="<%= posts.image %>">
            </div>
          </div>
          <% }) %>
    </div>
 
  </div>
</main>
  

</body>

<script>
  //console.log('<%= JSON.stringify(blogposts) %>');
  let main = document.querySelector("main")

  fetch('/homeData')
  .then(function(response) {
    return response.json()
})
.then(function(imageposts) {
  
  
  console.log(imageposts)
  let allData = imageposts.map(ele => ele.totalData.map(imageArray => imageArray))
  console.log(allData[0])
  
  allData.forEach(response => {
    response.forEach(eachImage => {
      console.log(eachImage)
    
      let city = document.createElement('city')
      city.textContent = eachImage.city
      main.appendChild(city)

    })

  })
    
  
  let count = imageposts[0].totalCount[0].count
  console.log(count)
  //console.log(data[0].totalData)
})
.catch(function(err) {
  console.log('Something went wrong!', err)
});

</script>

</html>
